var exec = require('sync-exec');
var fs = require('fs');
var _ = require('lodash');

const packageTpl = _.template(fs.readFileSync('./package.sample.json', 'utf-8'));

const names = [
  'wx',
  'wxa',
  'weixin',
  'wechat',
  'weapp',
  'we-app'
];

names.forEach(name => {
  [
    `babel-preset-${name}`,
    `create-${name}`,
    `eslint-plugin-${name}`,
    `${name}-components`,
    `${name}-deploy`,
    `${name}-devtools `,
    `${name}-dom`,
    `${name}-eslint`,
    `${name}-hmr `,
    `${name}-hot-loader`,
    `${name}-loader`,
    `${name}-motion`,
    `${name}-pack`,
    `${name}pm`,
    `${name}-preview`,
    `${name}-redux`,
    `${name}-router`,
    `${name}-server`,
    `${name}-storybook`,
    `${name}-tools`,
    `${name}-ui`,
    `${name}-upload`,
    `${name}-web`,
  ].forEach(packageName => {
    fs.writeFileSync('./package.json', packageTpl({ packageName }), 'utf-8');
    const ret = exec(`npm publish`);

    console.log(ret);
  });
});
